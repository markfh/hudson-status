#!/usr/bin/env ruby
require 'open-uri'
require 'nokogiri'

xml = `curl '#{ARGV[0]}/api/xml' --silent`.strip
Nokogiri.parse(xml).css('hudson > job').each do |job|
  color_codes = {
    'red' => 'Failed',
    'blue' => 'Success',
    'blue_anime' => 'Pending',
    'red_anime' => 'Pending'
  }
  name = job.css('name').first.content
  color = job.css('color').first.content
  color = (color_codes[color] || "Unknown #{color}")
  puts "#{name}: #{color}"
end
